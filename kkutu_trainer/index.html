<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Korean Typing Game</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: #f9f9f9;
    }

    #display {
      position: relative;
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    #lengthHint {
      position: absolute;
      bottom: 0;
      right: -1rem;
      font-size: 0.9rem;
      color: gray;
    }

    #input {
      font-size: 2rem;
      padding: 0.5rem 1rem;
      border: 2px solid #ccc;
      border-radius: 10px;
      outline: none;
      width: 300px;
      text-align: center;
      transition: all 0.3s;
    }

    #input::placeholder {
      opacity: 0.3;
    }

    #status {
      margin-top: 1rem;
      font-size: 1.5rem;
      transition: all 0.3s;
    }

    .green-pulse {
      color: green;
      animation: pulse 0.6s ease-out;
    }

    .red-text {
      color: red;
    }

    .black-text {
      color: black;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    #timer {
      position: fixed;
      bottom: 20px;
      font-size: 1.2rem;
      color: green;
    }
  </style>
</head>
<body>
  <div id="display">
    <span id="firstChar">?</span>
    <span id="lengthHint"></span>
  </div>
  <input type="text" id="input" placeholder="정답을 입력하세요..." autocomplete="off" />
  <div id="status"></div>
  <div id="timer">Time: 0s</div>

  <script>
    const input = document.getElementById('input');
    const status = document.getElementById('status');
    const firstChar = document.getElementById('firstChar');
    const lengthHint = document.getElementById('lengthHint');
    const timerDisplay = document.getElementById('timer');

    let words = [];
    let currentWord = "";
    let startTime = Date.now();

    // Timer
    setInterval(() => {
      const elapsed = Math.floor((Date.now() - startTime) / 1000);
      timerDisplay.textContent = `Time: ${elapsed}s`;
    }, 1000);

    function showNewWord() {
      currentWord = words[Math.floor(Math.random() * words.length)];
      firstChar.textContent = currentWord[0];
      lengthHint.textContent = currentWord.length;
      input.value = "";
      input.placeholder = currentWord; // Show faint full word
      status.textContent = "";
      input.classList.remove("green-pulse", "red-text");
    }

    input.addEventListener("input", () => {
      const typed = input.value;
      if (typed === "") {
        input.classList.remove("red-text", "black-text");
        return;
      }

      if (currentWord.startsWith(typed)) {
        input.classList.add("black-text");
        input.classList.remove("red-text");
      } else {
        input.classList.add("red-text");
        input.classList.remove("black-text");
      }
    });

    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        if (input.value === currentWord) {
          status.textContent = "Correct!";
          status.className = "green-pulse";
          input.classList.remove("red-text", "black-text");
          input.classList.add("green-pulse");
          setTimeout(showNewWord, 1000);
        } else {
          status.textContent = "Wrong!";
          status.className = "red-text";
        }
      }
    });

    fetch("words.txt")
      .then(res => res.text())
      .then(text => {
        words = text.split(/\r?\n/).filter(w => w.trim().length > 0);
        if (words.length > 0) {
          showNewWord();
        } else {
          firstChar.textContent = "No words";
        }
      })
      .catch(() => {
        firstChar.textContent = "Error loading file.";
      });
  </script>
</body>
</html>
